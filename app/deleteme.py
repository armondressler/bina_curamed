import numpy as np
import pandas as pd
from pandas import Period, Timestamp
from bokeh.palettes import Spectral6
from bokeh.plotting import ColumnDataSource, figure, show
from bokeh.models import HoverTool
from numpy import nan


a = {'date': {0: Timestamp('2021-09-17 00:00:00'), 1: Timestamp('2021-09-18 00:00:00'), 2: Timestamp('2021-09-19 00:00:00'), 3: Timestamp('2021-09-20 00:00:00'), 4: Timestamp('2021-09-21 00:00:00'), 5: Timestamp('2021-09-22 00:00:00'), 6: Timestamp('2021-09-23 00:00:00'), 7: Timestamp('2021-09-24 00:00:00'), 8: Timestamp('2021-09-25 00:00:00'), 9: Timestamp('2021-09-26 00:00:00'), 10: Timestamp('2021-09-27 00:00:00'), 11: Timestamp('2021-09-28 00:00:00'), 12: Timestamp('2021-09-29 00:00:00'), 13: Timestamp('2021-09-30 00:00:00'), 14: Timestamp('2021-10-01 00:00:00'), 15: Timestamp('2021-10-02 00:00:00'), 16: Timestamp('2021-10-03 00:00:00'), 17: Timestamp('2021-10-04 00:00:00'), 18: Timestamp('2021-10-05 00:00:00'), 19: Timestamp('2021-10-06 00:00:00'), 20: Timestamp('2021-10-07 00:00:00'), 21: Timestamp('2021-10-08 00:00:00'), 22: Timestamp('2021-10-09 00:00:00'), 23: Timestamp('2021-10-10 00:00:00'), 24: Timestamp('2021-10-11 00:00:00'), 25: Timestamp('2021-10-12 00:00:00'), 26: Timestamp('2021-10-13 00:00:00'), 27: Timestamp('2021-10-14 00:00:00'), 28: Timestamp('2021-10-15 00:00:00'), 29: Timestamp('2021-10-16 00:00:00'), 30: Timestamp('2021-10-17 00:00:00'), 31: Timestamp('2021-10-18 00:00:00'), 32: Timestamp('2021-10-19 00:00:00'), 33: Timestamp('2021-10-20 00:00:00'), 34: Timestamp('2021-10-21 00:00:00'), 35: Timestamp('2021-10-22 00:00:00'), 36: Timestamp('2021-10-23 00:00:00'), 37: Timestamp('2021-10-24 00:00:00'), 38: Timestamp('2021-10-25 00:00:00'), 39: Timestamp('2021-10-26 00:00:00'), 40: Timestamp('2021-10-27 00:00:00'), 41: Timestamp('2021-10-28 00:00:00'), 42: Timestamp('2021-10-29 00:00:00'), 43: Timestamp('2021-10-30 00:00:00'), 44: Timestamp('2021-10-31 00:00:00'), 45: Timestamp('2021-11-01 00:00:00'), 46: Timestamp('2021-11-02 00:00:00'), 47: Timestamp('2021-11-03 00:00:00'), 48: Timestamp('2021-11-04 00:00:00'), 49: Timestamp('2021-11-05 00:00:00'), 50: Timestamp('2021-11-06 00:00:00'), 51: Timestamp('2021-11-07 00:00:00'), 52: Timestamp('2021-11-08 00:00:00'), 53: Timestamp('2021-11-09 00:00:00'), 54: Timestamp('2021-11-10 00:00:00'), 55: Timestamp('2021-11-11 00:00:00'), 56: Timestamp('2021-11-12 00:00:00'), 57: Timestamp('2021-11-13 00:00:00'), 58: Timestamp('2021-11-14 00:00:00'), 59: Timestamp('2021-11-15 00:00:00'), 60: Timestamp('2021-11-16 00:00:00'), 61: Timestamp('2021-11-17 00:00:00'), 62: Timestamp('2021-11-18 00:00:00'), 63: Timestamp('2021-11-19 00:00:00'), 64: Timestamp('2021-11-20 00:00:00'), 65: Timestamp('2021-11-21 00:00:00'), 66: Timestamp('2021-11-22 00:00:00'), 67: Timestamp('2021-11-23 00:00:00'), 68: Timestamp('2021-11-24 00:00:00'), 69: Timestamp('2021-11-25 00:00:00'), 70: Timestamp('2021-11-26 00:00:00'), 71: Timestamp('2021-11-27 00:00:00'), 72: Timestamp('2021-11-28 00:00:00'), 73: Timestamp('2021-11-29 00:00:00'), 74: Timestamp('2021-11-30 00:00:00'), 75: Timestamp('2021-12-01 00:00:00'), 76: Timestamp('2021-12-02 00:00:00'), 77: Timestamp('2021-12-03 00:00:00'), 78: Timestamp('2021-12-04 00:00:00'), 79: Timestamp('2021-12-05 00:00:00'), 80: Timestamp('2021-12-06 00:00:00'), 81: Timestamp('2021-12-07 00:00:00'), 82: Timestamp('2021-12-08 00:00:00'), 83: Timestamp('2021-12-09 00:00:00'), 84: Timestamp('2021-12-10 00:00:00'), 85: Timestamp('2021-12-11 00:00:00'), 86: Timestamp('2021-12-12 00:00:00'), 87: Timestamp('2021-12-13 00:00:00'), 88: Timestamp('2021-12-14 00:00:00'), 89: Timestamp('2021-12-15 00:00:00'), 90: Timestamp('2021-12-16 00:00:00'), 91: Timestamp('2021-12-17 00:00:00'), 92: Timestamp('2021-12-18 00:00:00'), 93: Timestamp('2021-12-19 00:00:00'), 94: Timestamp('2021-12-20 00:00:00'), 95: Timestamp('2021-12-21 00:00:00'), 96: Timestamp('2021-12-22 00:00:00'), 97: Timestamp('2021-12-23 00:00:00'), 98: Timestamp('2021-12-24 00:00:00'), 99: Timestamp('2021-12-25 00:00:00'), 100: Timestamp('2021-12-26 00:00:00'), 101: Timestamp('2021-12-27 00:00:00'), 102: Timestamp('2021-12-28 00:00:00'), 103: Timestamp('2021-12-29 00:00:00'), 104: Timestamp('2021-12-30 00:00:00'), 105: Timestamp('2021-12-31 00:00:00'), 106: Timestamp('2022-01-01 00:00:00'), 107: Timestamp('2022-01-02 00:00:00'), 108: Timestamp('2022-01-03 00:00:00'), 109: Timestamp('2022-01-04 00:00:00'), 110: Timestamp('2022-01-05 00:00:00'), 111: Timestamp('2022-01-06 00:00:00'), 112: Timestamp('2022-01-07 00:00:00'), 113: Timestamp('2022-01-08 00:00:00'), 114: Timestamp('2022-01-09 00:00:00'), 115: Timestamp('2022-01-10 00:00:00'), 116: Timestamp('2022-01-11 00:00:00'), 117: Timestamp('2022-01-12 00:00:00'), 118: Timestamp('2022-01-13 00:00:00'), 119: Timestamp('2022-01-14 00:00:00'), 120: Timestamp('2022-01-15 00:00:00'), 121: Timestamp('2022-01-16 00:00:00'), 122: Timestamp('2022-01-17 00:00:00'), 123: Timestamp('2022-01-18 00:00:00'), 124: Timestamp('2022-01-19 00:00:00'), 125: Timestamp('2022-01-20 00:00:00'), 126: Timestamp('2022-01-21 00:00:00'), 127: Timestamp('2022-01-22 00:00:00'), 128: Timestamp('2022-01-23 00:00:00'), 129: Timestamp('2022-01-24 00:00:00'), 130: Timestamp('2022-01-25 00:00:00'), 131: Timestamp('2022-01-26 00:00:00'), 132: Timestamp('2022-01-27 00:00:00'), 133: Timestamp('2022-01-28 00:00:00'), 134: Timestamp('2022-01-29 00:00:00'), 135: Timestamp('2022-01-30 00:00:00'), 136: Timestamp('2022-01-31 00:00:00'), 137: Timestamp('2022-02-01 00:00:00'), 138: Timestamp('2022-02-02 00:00:00'), 139: Timestamp('2022-02-03 00:00:00'), 140: Timestamp('2022-02-04 00:00:00'), 141: Timestamp('2022-02-05 00:00:00'), 142: Timestamp('2022-02-06 00:00:00'), 143: Timestamp('2022-02-07 00:00:00'), 144: Timestamp('2022-02-08 00:00:00'), 145: Timestamp('2022-02-09 00:00:00'), 146: Timestamp('2022-02-10 00:00:00'), 147: Timestamp('2022-02-11 00:00:00'), 148: Timestamp('2022-02-12 00:00:00'), 149: Timestamp('2022-02-13 00:00:00'), 150: Timestamp('2022-02-14 00:00:00'), 151: Timestamp('2022-02-15 00:00:00'), 152: Timestamp('2022-02-16 00:00:00'), 153: Timestamp('2022-02-17 00:00:00'), 154: Timestamp('2022-02-18 00:00:00'), 155: Timestamp('2022-02-19 00:00:00'), 156: Timestamp('2022-02-20 00:00:00'), 157: Timestamp('2022-02-21 00:00:00'), 158: Timestamp('2022-02-22 00:00:00'), 159: Timestamp('2022-02-23 00:00:00'), 160: Timestamp('2022-02-24 00:00:00'), 161: Timestamp('2022-02-25 00:00:00'), 162: Timestamp('2022-02-26 00:00:00'), 163: Timestamp('2022-02-27 00:00:00'), 164: Timestamp('2022-02-28 00:00:00'), 165: Timestamp('2022-03-01 00:00:00'), 166: Timestamp('2022-03-02 00:00:00'), 167: Timestamp('2022-03-03 00:00:00'), 168: Timestamp('2022-03-04 00:00:00'), 169: Timestamp('2022-03-05 00:00:00'), 170: Timestamp('2022-03-06 00:00:00'), 171: Timestamp('2022-03-07 00:00:00'), 172: Timestamp('2022-03-08 00:00:00'), 173: Timestamp('2022-03-09 00:00:00'), 174: Timestamp('2022-03-10 00:00:00'), 175: Timestamp('2022-03-11 00:00:00'), 176: Timestamp('2022-03-12 00:00:00'), 177: Timestamp('2022-03-13 00:00:00'), 178: Timestamp('2022-03-14 00:00:00'), 179: Timestamp('2022-03-15 00:00:00'), 180: Timestamp('2022-03-16 00:00:00'), 181: Timestamp('2022-03-17 00:00:00'), 182: Timestamp('2022-03-18 00:00:00'), 183: Timestamp('2022-03-19 00:00:00'), 184: Timestamp('2022-03-20 00:00:00'), 185: Timestamp('2022-03-21 00:00:00'), 186: Timestamp('2022-03-22 00:00:00'), 187: Timestamp('2022-03-23 00:00:00'), 188: Timestamp('2022-03-24 00:00:00'), 189: Timestamp('2022-03-25 00:00:00'), 190: Timestamp('2022-03-26 00:00:00'), 191: Timestamp('2022-03-27 00:00:00'), 192: Timestamp('2022-03-28 00:00:00'), 193: Timestamp('2022-03-29 00:00:00'), 194: Timestamp('2022-03-30 00:00:00')}, 'SumTotalAmount': {0: 14.45, 1: 0.0, 2: 0.0, 3: 0.0, 4: 9.9, 5: 0.0, 6: 177.15, 7: 0.0, 8: 0.0, 9: 0.0, 10: 12.0, 11: 0.0, 12: 6.5, 13: 0.0, 14: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 18: 0.0, 19: 0.0, 20: 0.0, 21: 0.0, 22: 0.0, 23: 0.0, 24: 0.0, 25: 0.0, 26: 0.0, 27: 0.0, 28: 0.0, 29: 0.0, 30: 0.0, 31: 0.0, 32: 0.0, 33: 0.0, 34: 0.0, 35: 16.35, 36: 0.0, 37: 0.0, 38: 0.0, 39: 0.0, 40: 0.0, 41: 0.0, 42: 0.0, 43: 0.0, 44: 0.0, 45: 0.0, 46: 0.0, 47: 0.0, 48: 0.0, 49: 0.0, 50: 0.0, 51: 0.0, 52: 0.0, 53: 0.0, 54: 0.0, 55: 0.0, 56: 0.0, 57: 0.0, 58: 0.0, 59: 0.0, 60: 0.0, 61: 0.0, 62: 0.0, 63: 0.0, 64: 0.0, 65: 0.0, 66: 40.01, 67: 0.0, 68: 189.43, 69: 153.0, 70: 0.0, 71: 0.0, 72: 0.0, 73: 0.0, 74: 0.0, 75: 80.95, 76: 0.0, 77: 0.0, 78: 0.0, 79: 0.0, 80: 0.0, 81: 0.0, 82: 0.0, 83: 0.0, 84: 0.0, 85: 0.0, 86: 0.0, 87: 0.0, 88: 0.0, 89: 97.5, 90: 32.5, 91: 19.6, 92: 0.0, 93: 0.0, 94: 0.0, 95: 0.0, 96: 0.0, 97: 0.0, 98: 0.0, 99: 0.0, 100: 0.0, 101: 0.0, 102: 32.5, 103: 0.0, 104: 0.0, 105: 0.0, 106: 0.0, 107: 0.0, 108: 0.0, 109: 0.0, 110: 0.0, 111: 0.0, 112: 0.0, 113: 0.0, 114: 0.0, 115: 94.17, 116: 0.0, 117: 0.0, 118: 0.0, 119: 0.0, 120: 0.0, 121: 0.0, 122: 0.0, 123: 0.0, 124: 0.0, 125: 0.0, 126: 123.74, 127: 0.0, 128: 0.0, 129: 0.0, 130: 0.0, 131: 0.0, 132: 67.45, 133: 0.0, 134: 0.0, 135: 0.0, 136: 0.0, 137: 94.17, 138: 0.0, 139: 0.0, 140: 0.0, 141: 0.0, 142: 0.0, 143: 0.0, 144: 0.0, 145: 0.0, 146: 13.45, 147: 0.0, 148: 0.0, 149: 0.0, 150: 0.0, 151: 41.41, 152: 111.06, 153: 0.0, 154: 413.55, 155: 16.0, 156: 0.0, 157: 0.0, 158: 235.64, 159: 105.47, 160: 105.07, 161: 0.0, 162: 0.0, 163: 0.0, 164: 94.17, 165: 111.76, 166: 0.0, 167: 85.46, 168: 0.0, 169: 0.0, 170: 0.0, 171: 0.0, 172: 0.0, 173: 0.0, 174: 0.0, 175: 0.0, 176: 0.0, 177: 0.0, 178: 40.01, 179: 0.0, 180: 193.36, 181: 0.0, 182: 0.0, 183: 0.0, 184: 0.0, 185: 0.0, 186: 0.0, 187: 0.0, 188: 170.23, 189: 66.41, 190: 0.0, 191: 0.0, 192: 0.0, 193: 0.0, 194: 390.12}, 'SumTotalTar': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 51.92, 7: 0.0, 8: 0.0, 9: 0.0, 10: 0.0, 11: 0.0, 12: 0.0, 13: 0.0, 14: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 18: 0.0, 19: 0.0, 20: 0.0, 21: 0.0, 22: 0.0, 23: 0.0, 24: 0.0, 25: 0.0, 26: 0.0, 27: 0.0, 28: 0.0, 29: 0.0, 30: 0.0, 31: 0.0, 32: 0.0, 33: 0.0, 34: 0.0, 35: 0.0, 36: 0.0, 37: 0.0, 38: 0.0, 39: 0.0, 40: 0.0, 41: 0.0, 42: 0.0, 43: 0.0, 44: 0.0, 45: 0.0, 46: 0.0, 47: 0.0, 48: 0.0, 49: 0.0, 50: 0.0, 51: 0.0, 52: 0.0, 53: 0.0, 54: 0.0, 55: 0.0, 56: 0.0, 57: 0.0, 58: 0.0, 59: 0.0, 60: 0.0, 61: 0.0, 62: 0.0, 63: 0.0, 64: 0.0, 65: 0.0, 66: 22.4, 67: 0.0, 68: 76.16, 69: 67.19999999999999, 70: 0.0, 71: 0.0, 72: 0.0, 73: 0.0, 74: 0.0, 75: 0.0, 76: 0.0, 77: 0.0, 78: 0.0, 79: 0.0, 80: 0.0, 81: 0.0, 82: 0.0, 83: 0.0, 84: 0.0, 85: 0.0, 86: 0.0, 87: 0.0, 88: 0.0, 89: 0.0, 90: 0.0, 91: 0.0, 92: 0.0, 93: 0.0, 94: 0.0, 95: 0.0, 96: 0.0, 97: 0.0, 98: 0.0, 99: 0.0, 100: 0.0, 101: 0.0, 102: 0.0, 103: 0.0, 104: 0.0, 105: 0.0, 106: 0.0, 107: 0.0, 108: 0.0, 109: 0.0, 110: 0.0, 111: 0.0, 112: 0.0, 113: 0.0, 114: 0.0, 115: 51.0, 116: 0.0, 117: 0.0, 118: 0.0, 119: 0.0, 120: 0.0, 121: 0.0, 122: 0.0, 123: 0.0, 124: 0.0, 125: 0.0, 126: 60.28, 127: 0.0, 128: 0.0, 129: 0.0, 130: 0.0, 131: 0.0, 132: 0.0, 133: 0.0, 134: 0.0, 135: 0.0, 136: 0.0, 137: 51.0, 138: 0.0, 139: 0.0, 140: 0.0, 141: 0.0, 142: 0.0, 143: 0.0, 144: 0.0, 145: 0.0, 146: 0.0, 147: 0.0, 148: 0.0, 149: 0.0, 150: 0.0, 151: 23.18, 152: 22.4, 153: 0.0, 154: 168.12, 155: 8.96, 156: 0.0, 157: 0.0, 158: 162.16, 159: 74.36, 160: 74.36, 161: 0.0, 162: 0.0, 163: 0.0, 164: 51.0, 165: 60.28, 166: 0.0, 167: 65.4, 168: 0.0, 169: 0.0, 170: 0.0, 171: 0.0, 172: 0.0, 173: 0.0, 174: 0.0, 175: 0.0, 176: 0.0, 177: 0.0, 178: 22.4, 179: 0.0, 180: 109.47, 181: 0.0, 182: 0.0, 183: 0.0, 184: 0.0, 185: 0.0, 186: 0.0, 187: 0.0, 188: 75.53, 189: 23.18, 190: 0.0, 191: 0.0, 192: 0.0, 193: 0.0, 194: 168.44}, 'SumTotalTar2': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 40.88, 7: 0.0, 8: 0.0, 9: 0.0, 10: 0.0, 11: 0.0, 12: 0.0, 13: 0.0, 14: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 18: 0.0, 19: 0.0, 20: 0.0, 21: 0.0, 22: 0.0, 23: 0.0, 24: 0.0, 25: 0.0, 26: 0.0, 27: 0.0, 28: 0.0, 29: 0.0, 30: 0.0, 31: 0.0, 32: 0.0, 33: 0.0, 34: 0.0, 35: 0.0, 36: 0.0, 37: 0.0, 38: 0.0, 39: 0.0, 40: 0.0, 41: 0.0, 42: 0.0, 43: 0.0, 44: 0.0, 45: 0.0, 46: 0.0, 47: 0.0, 48: 0.0, 49: 0.0, 50: 0.0, 51: 0.0, 52: 0.0, 53: 0.0, 54: 0.0, 55: 0.0, 56: 0.0, 57: 0.0, 58: 0.0, 59: 0.0, 60: 0.0, 61: 0.0, 62: 0.0, 63: 0.0, 64: 0.0, 65: 0.0, 66: 17.61, 67: 0.0, 68: 82.42, 69: 64.1, 70: 0.0, 71: 0.0, 72: 0.0, 73: 0.0, 74: 0.0, 75: 0.0, 76: 0.0, 77: 0.0, 78: 0.0, 79: 0.0, 80: 0.0, 81: 0.0, 82: 0.0, 83: 0.0, 84: 0.0, 85: 0.0, 86: 0.0, 87: 0.0, 88: 0.0, 89: 0.0, 90: 0.0, 91: 0.0, 92: 0.0, 93: 0.0, 94: 0.0, 95: 0.0, 96: 0.0, 97: 0.0, 98: 0.0, 99: 0.0, 100: 0.0, 101: 0.0, 102: 0.0, 103: 0.0, 104: 0.0, 105: 0.0, 106: 0.0, 107: 0.0, 108: 0.0, 109: 0.0, 110: 0.0, 111: 0.0, 112: 0.0, 113: 0.0, 114: 0.0, 115: 43.17, 116: 0.0, 117: 0.0, 118: 0.0, 119: 0.0, 120: 0.0, 121: 0.0, 122: 0.0, 123: 0.0, 124: 0.0, 125: 0.0, 126: 50.46, 127: 0.0, 128: 0.0, 129: 0.0, 130: 0.0, 131: 0.0, 132: 0.0, 133: 0.0, 134: 0.0, 135: 0.0, 136: 0.0, 137: 43.17, 138: 0.0, 139: 0.0, 140: 0.0, 141: 0.0, 142: 0.0, 143: 0.0, 144: 0.0, 145: 0.0, 146: 0.0, 147: 0.0, 148: 0.0, 149: 0.0, 150: 0.0, 151: 18.23, 152: 17.61, 153: 0.0, 154: 103.33, 155: 7.04, 156: 0.0, 157: 0.0, 158: 59.879999999999995, 159: 24.66, 160: 24.66, 161: 0.0, 162: 0.0, 163: 0.0, 164: 43.17, 165: 51.48, 166: 0.0, 167: 17.61, 168: 0.0, 169: 0.0, 170: 0.0, 171: 0.0, 172: 0.0, 173: 0.0, 174: 0.0, 175: 0.0, 176: 0.0, 177: 0.0, 178: 17.61, 179: 0.0, 180: 83.89, 181: 0.0, 182: 0.0, 183: 0.0, 184: 0.0, 185: 0.0, 186: 0.0, 187: 0.0, 188: 78.9, 189: 18.23, 190: 0.0, 191: 0.0, 192: 0.0, 193: 0.0, 194: 176.48}, 'SumTotalMedication': {0: 14.45, 1: 0.0, 2: 0.0, 3: 0.0, 4: 9.9, 5: 0.0, 6: 72.35, 7: 0.0, 8: 0.0, 9: 0.0, 10: 0.0, 11: 0.0, 12: 6.5, 13: 0.0, 14: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 18: 0.0, 19: 0.0, 20: 0.0, 21: 0.0, 22: 0.0, 23: 0.0, 24: 0.0, 25: 0.0, 26: 0.0, 27: 0.0, 28: 0.0, 29: 0.0, 30: 0.0, 31: 0.0, 32: 0.0, 33: 0.0, 34: 0.0, 35: 16.35, 36: 0.0, 37: 0.0, 38: 0.0, 39: 0.0, 40: 0.0, 41: 0.0, 42: 0.0, 43: 0.0, 44: 0.0, 45: 0.0, 46: 0.0, 47: 0.0, 48: 0.0, 49: 0.0, 50: 0.0, 51: 0.0, 52: 0.0, 53: 0.0, 54: 0.0, 55: 0.0, 56: 0.0, 57: 0.0, 58: 0.0, 59: 0.0, 60: 0.0, 61: 0.0, 62: 0.0, 63: 0.0, 64: 0.0, 65: 0.0, 66: 0.0, 67: 0.0, 68: 30.85, 69: 21.7, 70: 0.0, 71: 0.0, 72: 0.0, 73: 0.0, 74: 0.0, 75: 80.95, 76: 0.0, 77: 0.0, 78: 0.0, 79: 0.0, 80: 0.0, 81: 0.0, 82: 0.0, 83: 0.0, 84: 0.0, 85: 0.0, 86: 0.0, 87: 0.0, 88: 0.0, 89: 0.0, 90: 0.0, 91: 19.6, 92: 0.0, 93: 0.0, 94: 0.0, 95: 0.0, 96: 0.0, 97: 0.0, 98: 0.0, 99: 0.0, 100: 0.0, 101: 0.0, 102: 0.0, 103: 0.0, 104: 0.0, 105: 0.0, 106: 0.0, 107: 0.0, 108: 0.0, 109: 0.0, 110: 0.0, 111: 0.0, 112: 0.0, 113: 0.0, 114: 0.0, 115: 0.0, 116: 0.0, 117: 0.0, 118: 0.0, 119: 0.0, 120: 0.0, 121: 0.0, 122: 0.0, 123: 0.0, 124: 0.0, 125: 0.0, 126: 13.0, 127: 0.0, 128: 0.0, 129: 0.0, 130: 0.0, 131: 0.0, 132: 67.45, 133: 0.0, 134: 0.0, 135: 0.0, 136: 0.0, 137: 0.0, 138: 0.0, 139: 0.0, 140: 0.0, 141: 0.0, 142: 0.0, 143: 0.0, 144: 0.0, 145: 0.0, 146: 13.45, 147: 0.0, 148: 0.0, 149: 0.0, 150: 0.0, 151: 0.0, 152: 71.05, 153: 0.0, 154: 142.1, 155: 0.0, 156: 0.0, 157: 0.0, 158: 13.6, 159: 6.45, 160: 6.05, 161: 0.0, 162: 0.0, 163: 0.0, 164: 0.0, 165: 0.0, 166: 0.0, 167: 2.45, 168: 0.0, 169: 0.0, 170: 0.0, 171: 0.0, 172: 0.0, 173: 0.0, 174: 0.0, 175: 0.0, 176: 0.0, 177: 0.0, 178: 0.0, 179: 0.0, 180: 0.0, 181: 0.0, 182: 0.0, 183: 0.0, 184: 0.0, 185: 0.0, 186: 0.0, 187: 0.0, 188: 15.8, 189: 0.0, 190: 0.0, 191: 0.0, 192: 0.0, 193: 0.0, 194: 20.200000000000003}, 'SumTotalMigel': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 10: 0.0, 11: 0.0, 12: 0.0, 13: 0.0, 14: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 18: 0.0, 19: 0.0, 20: 0.0, 21: 0.0, 22: 0.0, 23: 0.0, 24: 0.0, 25: 0.0, 26: 0.0, 27: 0.0, 28: 0.0, 29: 0.0, 30: 0.0, 31: 0.0, 32: 0.0, 33: 0.0, 34: 0.0, 35: 0.0, 36: 0.0, 37: 0.0, 38: 0.0, 39: 0.0, 40: 0.0, 41: 0.0, 42: 0.0, 43: 0.0, 44: 0.0, 45: 0.0, 46: 0.0, 47: 0.0, 48: 0.0, 49: 0.0, 50: 0.0, 51: 0.0, 52: 0.0, 53: 0.0, 54: 0.0, 55: 0.0, 56: 0.0, 57: 0.0, 58: 0.0, 59: 0.0, 60: 0.0, 61: 0.0, 62: 0.0, 63: 0.0, 64: 0.0, 65: 0.0, 66: 0.0, 67: 0.0, 68: 0.0, 69: 0.0, 70: 0.0, 71: 0.0, 72: 0.0, 73: 0.0, 74: 0.0, 75: 0.0, 76: 0.0, 77: 0.0, 78: 0.0, 79: 0.0, 80: 0.0, 81: 0.0, 82: 0.0, 83: 0.0, 84: 0.0, 85: 0.0, 86: 0.0, 87: 0.0, 88: 0.0, 89: 0.0, 90: 0.0, 91: 0.0, 92: 0.0, 93: 0.0, 94: 0.0, 95: 0.0, 96: 0.0, 97: 0.0, 98: 0.0, 99: 0.0, 100: 0.0, 101: 0.0, 102: 0.0, 103: 0.0, 104: 0.0, 105: 0.0, 106: 0.0, 107: 0.0, 108: 0.0, 109: 0.0, 110: 0.0, 111: 0.0, 112: 0.0, 113: 0.0, 114: 0.0, 115: 0.0, 116: 0.0, 117: 0.0, 118: 0.0, 119: 0.0, 120: 0.0, 121: 0.0, 122: 0.0, 123: 0.0, 124: 0.0, 125: 0.0, 126: 0.0, 127: 0.0, 128: 0.0, 129: 0.0, 130: 0.0, 131: 0.0, 132: 0.0, 133: 0.0, 134: 0.0, 135: 0.0, 136: 0.0, 137: 0.0, 138: 0.0, 139: 0.0, 140: 0.0, 141: 0.0, 142: 0.0, 143: 0.0, 144: 0.0, 145: 0.0, 146: 0.0, 147: 0.0, 148: 0.0, 149: 0.0, 150: 0.0, 151: 0.0, 152: 0.0, 153: 0.0, 154: 0.0, 155: 0.0, 156: 0.0, 157: 0.0, 158: 0.0, 159: 0.0, 160: 0.0, 161: 0.0, 162: 0.0, 163: 0.0, 164: 0.0, 165: 0.0, 166: 0.0, 167: 0.0, 168: 0.0, 169: 0.0, 170: 0.0, 171: 0.0, 172: 0.0, 173: 0.0, 174: 0.0, 175: 0.0, 176: 0.0, 177: 0.0, 178: 0.0, 179: 0.0, 180: 0.0, 181: 0.0, 182: 0.0, 183: 0.0, 184: 0.0, 185: 0.0, 186: 0.0, 187: 0.0, 188: 0.0, 189: 0.0, 190: 0.0, 191: 0.0, 192: 0.0, 193: 0.0, 194: 0.0}, 'SumTotalAnalysis': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 10: 0.0, 11: 0.0, 12: 0.0, 13: 0.0, 14: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 18: 0.0, 19: 0.0, 20: 0.0, 21: 0.0, 22: 0.0, 23: 0.0, 24: 0.0, 25: 0.0, 26: 0.0, 27: 0.0, 28: 0.0, 29: 0.0, 30: 0.0, 31: 0.0, 32: 0.0, 33: 0.0, 34: 0.0, 35: 0.0, 36: 0.0, 37: 0.0, 38: 0.0, 39: 0.0, 40: 0.0, 41: 0.0, 42: 0.0, 43: 0.0, 44: 0.0, 45: 0.0, 46: 0.0, 47: 0.0, 48: 0.0, 49: 0.0, 50: 0.0, 51: 0.0, 52: 0.0, 53: 0.0, 54: 0.0, 55: 0.0, 56: 0.0, 57: 0.0, 58: 0.0, 59: 0.0, 60: 0.0, 61: 0.0, 62: 0.0, 63: 0.0, 64: 0.0, 65: 0.0, 66: 0.0, 67: 0.0, 68: 0.0, 69: 0.0, 70: 0.0, 71: 0.0, 72: 0.0, 73: 0.0, 74: 0.0, 75: 0.0, 76: 0.0, 77: 0.0, 78: 0.0, 79: 0.0, 80: 0.0, 81: 0.0, 82: 0.0, 83: 0.0, 84: 0.0, 85: 0.0, 86: 0.0, 87: 0.0, 88: 0.0, 89: 0.0, 90: 0.0, 91: 0.0, 92: 0.0, 93: 0.0, 94: 0.0, 95: 0.0, 96: 0.0, 97: 0.0, 98: 0.0, 99: 0.0, 100: 0.0, 101: 0.0, 102: 0.0, 103: 0.0, 104: 0.0, 105: 0.0, 106: 0.0, 107: 0.0, 108: 0.0, 109: 0.0, 110: 0.0, 111: 0.0, 112: 0.0, 113: 0.0, 114: 0.0, 115: 0.0, 116: 0.0, 117: 0.0, 118: 0.0, 119: 0.0, 120: 0.0, 121: 0.0, 122: 0.0, 123: 0.0, 124: 0.0, 125: 0.0, 126: 0.0, 127: 0.0, 128: 0.0, 129: 0.0, 130: 0.0, 131: 0.0, 132: 0.0, 133: 0.0, 134: 0.0, 135: 0.0, 136: 0.0, 137: 0.0, 138: 0.0, 139: 0.0, 140: 0.0, 141: 0.0, 142: 0.0, 143: 0.0, 144: 0.0, 145: 0.0, 146: 0.0, 147: 0.0, 148: 0.0, 149: 0.0, 150: 0.0, 151: 0.0, 152: 0.0, 153: 0.0, 154: 0.0, 155: 0.0, 156: 0.0, 157: 0.0, 158: 0.0, 159: 0.0, 160: 0.0, 161: 0.0, 162: 0.0, 163: 0.0, 164: 0.0, 165: 0.0, 166: 0.0, 167: 0.0, 168: 0.0, 169: 0.0, 170: 0.0, 171: 0.0, 172: 0.0, 173: 0.0, 174: 0.0, 175: 0.0, 176: 0.0, 177: 0.0, 178: 0.0, 179: 0.0, 180: 0.0, 181: 0.0, 182: 0.0, 183: 0.0, 184: 0.0, 185: 0.0, 186: 0.0, 187: 0.0, 188: 0.0, 189: 0.0, 190: 0.0, 191: 0.0, 192: 0.0, 193: 0.0, 194: 0.0}, 'SumTotalPhysio': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 10: 0.0, 11: 0.0, 12: 0.0, 13: 0.0, 14: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 18: 0.0, 19: 0.0, 20: 0.0, 21: 0.0, 22: 0.0, 23: 0.0, 24: 0.0, 25: 0.0, 26: 0.0, 27: 0.0, 28: 0.0, 29: 0.0, 30: 0.0, 31: 0.0, 32: 0.0, 33: 0.0, 34: 0.0, 35: 0.0, 36: 0.0, 37: 0.0, 38: 0.0, 39: 0.0, 40: 0.0, 41: 0.0, 42: 0.0, 43: 0.0, 44: 0.0, 45: 0.0, 46: 0.0, 47: 0.0, 48: 0.0, 49: 0.0, 50: 0.0, 51: 0.0, 52: 0.0, 53: 0.0, 54: 0.0, 55: 0.0, 56: 0.0, 57: 0.0, 58: 0.0, 59: 0.0, 60: 0.0, 61: 0.0, 62: 0.0, 63: 0.0, 64: 0.0, 65: 0.0, 66: 0.0, 67: 0.0, 68: 0.0, 69: 0.0, 70: 0.0, 71: 0.0, 72: 0.0, 73: 0.0, 74: 0.0, 75: 0.0, 76: 0.0, 77: 0.0, 78: 0.0, 79: 0.0, 80: 0.0, 81: 0.0, 82: 0.0, 83: 0.0, 84: 0.0, 85: 0.0, 86: 0.0, 87: 0.0, 88: 0.0, 89: 0.0, 90: 0.0, 91: 0.0, 92: 0.0, 93: 0.0, 94: 0.0, 95: 0.0, 96: 0.0, 97: 0.0, 98: 0.0, 99: 0.0, 100: 0.0, 101: 0.0, 102: 0.0, 103: 0.0, 104: 0.0, 105: 0.0, 106: 0.0, 107: 0.0, 108: 0.0, 109: 0.0, 110: 0.0, 111: 0.0, 112: 0.0, 113: 0.0, 114: 0.0, 115: 0.0, 116: 0.0, 117: 0.0, 118: 0.0, 119: 0.0, 120: 0.0, 121: 0.0, 122: 0.0, 123: 0.0, 124: 0.0, 125: 0.0, 126: 0.0, 127: 0.0, 128: 0.0, 129: 0.0, 130: 0.0, 131: 0.0, 132: 0.0, 133: 0.0, 134: 0.0, 135: 0.0, 136: 0.0, 137: 0.0, 138: 0.0, 139: 0.0, 140: 0.0, 141: 0.0, 142: 0.0, 143: 0.0, 144: 0.0, 145: 0.0, 146: 0.0, 147: 0.0, 148: 0.0, 149: 0.0, 150: 0.0, 151: 0.0, 152: 0.0, 153: 0.0, 154: 0.0, 155: 0.0, 156: 0.0, 157: 0.0, 158: 0.0, 159: 0.0, 160: 0.0, 161: 0.0, 162: 0.0, 163: 0.0, 164: 0.0, 165: 0.0, 166: 0.0, 167: 0.0, 168: 0.0, 169: 0.0, 170: 0.0, 171: 0.0, 172: 0.0, 173: 0.0, 174: 0.0, 175: 0.0, 176: 0.0, 177: 0.0, 178: 0.0, 179: 0.0, 180: 0.0, 181: 0.0, 182: 0.0, 183: 0.0, 184: 0.0, 185: 0.0, 186: 0.0, 187: 0.0, 188: 0.0, 189: 0.0, 190: 0.0, 191: 0.0, 192: 0.0, 193: 0.0, 194: 0.0}, 'SumTotalMisc': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 10: 0.0, 11: 0.0, 12: 0.0, 13: 0.0, 14: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 18: 0.0, 19: 0.0, 20: 0.0, 21: 0.0, 22: 0.0, 23: 0.0, 24: 0.0, 25: 0.0, 26: 0.0, 27: 0.0, 28: 0.0, 29: 0.0, 30: 0.0, 31: 0.0, 32: 0.0, 33: 0.0, 34: 0.0, 35: 0.0, 36: 0.0, 37: 0.0, 38: 0.0, 39: 0.0, 40: 0.0, 41: 0.0, 42: 0.0, 43: 0.0, 44: 0.0, 45: 0.0, 46: 0.0, 47: 0.0, 48: 0.0, 49: 0.0, 50: 0.0, 51: 0.0, 52: 0.0, 53: 0.0, 54: 0.0, 55: 0.0, 56: 0.0, 57: 0.0, 58: 0.0, 59: 0.0, 60: 0.0, 61: 0.0, 62: 0.0, 63: 0.0, 64: 0.0, 65: 0.0, 66: 0.0, 67: 0.0, 68: 0.0, 69: 0.0, 70: 0.0, 71: 0.0, 72: 0.0, 73: 0.0, 74: 0.0, 75: 0.0, 76: 0.0, 77: 0.0, 78: 0.0, 79: 0.0, 80: 0.0, 81: 0.0, 82: 0.0, 83: 0.0, 84: 0.0, 85: 0.0, 86: 0.0, 87: 0.0, 88: 0.0, 89: 0.0, 90: 0.0, 91: 0.0, 92: 0.0, 93: 0.0, 94: 0.0, 95: 0.0, 96: 0.0, 97: 0.0, 98: 0.0, 99: 0.0, 100: 0.0, 101: 0.0, 102: 0.0, 103: 0.0, 104: 0.0, 105: 0.0, 106: 0.0, 107: 0.0, 108: 0.0, 109: 0.0, 110: 0.0, 111: 0.0, 112: 0.0, 113: 0.0, 114: 0.0, 115: 0.0, 116: 0.0, 117: 0.0, 118: 0.0, 119: 0.0, 120: 0.0, 121: 0.0, 122: 0.0, 123: 0.0, 124: 0.0, 125: 0.0, 126: 0.0, 127: 0.0, 128: 0.0, 129: 0.0, 130: 0.0, 131: 0.0, 132: 0.0, 133: 0.0, 134: 0.0, 135: 0.0, 136: 0.0, 137: 0.0, 138: 0.0, 139: 0.0, 140: 0.0, 141: 0.0, 142: 0.0, 143: 0.0, 144: 0.0, 145: 0.0, 146: 0.0, 147: 0.0, 148: 0.0, 149: 0.0, 150: 0.0, 151: 0.0, 152: 0.0, 153: 0.0, 154: 0.0, 155: 0.0, 156: 0.0, 157: 0.0, 158: 0.0, 159: 0.0, 160: 0.0, 161: 0.0, 162: 0.0, 163: 0.0, 164: 0.0, 165: 0.0, 166: 0.0, 167: 0.0, 168: 0.0, 169: 0.0, 170: 0.0, 171: 0.0, 172: 0.0, 173: 0.0, 174: 0.0, 175: 0.0, 176: 0.0, 177: 0.0, 178: 0.0, 179: 0.0, 180: 0.0, 181: 0.0, 182: 0.0, 183: 0.0, 184: 0.0, 185: 0.0, 186: 0.0, 187: 0.0, 188: 0.0, 189: 0.0, 190: 0.0, 191: 0.0, 192: 0.0, 193: 0.0, 194: 0.0}, 'SumTotalOther': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 12.0, 7: 0.0, 8: 0.0, 9: 0.0, 10: 12.0, 11: 0.0, 12: 0.0, 13: 0.0, 14: 0.0, 15: 0.0, 16: 0.0, 17: 0.0, 18: 0.0, 19: 0.0, 20: 0.0, 21: 0.0, 22: 0.0, 23: 0.0, 24: 0.0, 25: 0.0, 26: 0.0, 27: 0.0, 28: 0.0, 29: 0.0, 30: 0.0, 31: 0.0, 32: 0.0, 33: 0.0, 34: 0.0, 35: 0.0, 36: 0.0, 37: 0.0, 38: 0.0, 39: 0.0, 40: 0.0, 41: 0.0, 42: 0.0, 43: 0.0, 44: 0.0, 45: 0.0, 46: 0.0, 47: 0.0, 48: 0.0, 49: 0.0, 50: 0.0, 51: 0.0, 52: 0.0, 53: 0.0, 54: 0.0, 55: 0.0, 56: 0.0, 57: 0.0, 58: 0.0, 59: 0.0, 60: 0.0, 61: 0.0, 62: 0.0, 63: 0.0, 64: 0.0, 65: 0.0, 66: 0.0, 67: 0.0, 68: 0.0, 69: 0.0, 70: 0.0, 71: 0.0, 72: 0.0, 73: 0.0, 74: 0.0, 75: 0.0, 76: 0.0, 77: 0.0, 78: 0.0, 79: 0.0, 80: 0.0, 81: 0.0, 82: 0.0, 83: 0.0, 84: 0.0, 85: 0.0, 86: 0.0, 87: 0.0, 88: 0.0, 89: 97.5, 90: 32.5, 91: 0.0, 92: 0.0, 93: 0.0, 94: 0.0, 95: 0.0, 96: 0.0, 97: 0.0, 98: 0.0, 99: 0.0, 100: 0.0, 101: 0.0, 102: 32.5, 103: 0.0, 104: 0.0, 105: 0.0, 106: 0.0, 107: 0.0, 108: 0.0, 109: 0.0, 110: 0.0, 111: 0.0, 112: 0.0, 113: 0.0, 114: 0.0, 115: 0.0, 116: 0.0, 117: 0.0, 118: 0.0, 119: 0.0, 120: 0.0, 121: 0.0, 122: 0.0, 123: 0.0, 124: 0.0, 125: 0.0, 126: 0.0, 127: 0.0, 128: 0.0, 129: 0.0, 130: 0.0, 131: 0.0, 132: 0.0, 133: 0.0, 134: 0.0, 135: 0.0, 136: 0.0, 137: 0.0, 138: 0.0, 139: 0.0, 140: 0.0, 141: 0.0, 142: 0.0, 143: 0.0, 144: 0.0, 145: 0.0, 146: 0.0, 147: 0.0, 148: 0.0, 149: 0.0, 150: 0.0, 151: 0.0, 152: 0.0, 153: 0.0, 154: 0.0, 155: 0.0, 156: 0.0, 157: 0.0, 158: 0.0, 159: 0.0, 160: 0.0, 161: 0.0, 162: 0.0, 163: 0.0, 164: 0.0, 165: 0.0, 166: 0.0, 167: 0.0, 168: 0.0, 169: 0.0, 170: 0.0, 171: 0.0, 172: 0.0, 173: 0.0, 174: 0.0, 175: 0.0, 176: 0.0, 177: 0.0, 178: 0.0, 179: 0.0, 180: 0.0, 181: 0.0, 182: 0.0, 183: 0.0, 184: 0.0, 185: 0.0, 186: 0.0, 187: 0.0, 188: 0.0, 189: 25.0, 190: 0.0, 191: 0.0, 192: 0.0, 193: 0.0, 194: 25.0}}

df = pd.DataFrame.from_dict(a)


#df = df.groupby(["date","SumTotalAmount","SumTotalTar","SumTotalTar2","SumTotalMedication","SumTotalMigel","SumTotalAnalysis","SumTotalPhysio","SumTotalMisc","SumTotalOther"], as_index=True).sum().reset_index()

#df = df.pivot(index="date", columns=["SumTotalAmount","SumTotalTar","SumTotalTar2","SumTotalMedication","SumTotalMigel","SumTotalAnalysis","SumTotalPhysio","SumTotalMisc","SumTotalOther"]).fillna(0)
#df = df.groupby(["date"]).sum()

#df.drop("SumTotalAmount", axis=1, inplace=True)
df = df.groupby([df.date.dt.to_period('M')], as_index=True).sum().reset_index()
#df["date"] = {0: Period('2021-09', 'M'), 1: Period('2021-10', 'M'), 2: Period('2021-11', 'M'), 3: Period('2021-12', 'M'), 4: Period('2022-01', 'M'), 5: Period('2022-02', 'M'), 6: Period('2022-03', 'M')}
#df = df.pivot(index="date", columns=["SumTotalAmount","SumTotalTar","SumTotalTar2","SumTotalMedication","SumTotalMigel","SumTotalAnalysis","SumTotalPhysio","SumTotalMisc","SumTotalOther"]).fillna(0)
print(df.date.astype('datetime64[ns]') + pd.offsets.SemiMonthEnd() )
#df["date"] = df["date"].to_period() + pd.DateOffset(days=15)

